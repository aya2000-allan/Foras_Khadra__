@{
    ViewData["Title"] = "Home Page";
}

<!-- External styles and icon library -->
<link href="/css/Home.css" rel="stylesheet" />
<script src="https://code.iconify.design/iconify-icon/1.0.8/iconify-icon.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>

<style>
    .custom-arrow {
        position: static;
        width: 42px;
        height: 42px;
        border-radius: 50%;
        background: #E9F7ED;
        color: var(--green);
    }

        .custom-arrow::after {
            font-size: 16px;
            font-weight: bold;
        }

    .article-img {
        width: 353px;
        height: 269px;
        overflow: hidden;
        border-radius: 20px 20px 0 0;
    }

        .article-img img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* مهم جداً */
            display: block;
        }

    .swiper {
        width: 100%;
    }

    .swiper-wrapper {
        display: flex !important;
        flex-direction: row !important;
    }

    .swiper-slide {
        height: auto;
        display: flex;
        justify-content: center;
    }
</style>
<!-- Main Container -->
<div class="container-fluid py-5 rtl " style="position:relative;margin:7% 0;">

    <!-- Floating Circles -->
    <div class="floating-shapes" id="floatingShapes"></div>

    <div class="row align-items-start flex-lg-nowrap justify-content-between m-0">

        <!-- Right: Text and search -->
        <div class="col-lg-5 custom-col-full" style="padding:27px 0 ;">
            <h2 class=" mb-3 main-header">
                منصة فرص خضراء
            </h2>
            <h4 class="mb-4" style="color:var(--textColor); font-size:40px;font-weight:500; font-stretch: expanded;">من وإلى شباب عربي</h4>
            <p class="mb-4 responsive-text" style="font-size:20px;font-weight:350; text-align:justify;max-width:443px">
                هذا النص هو مثال لنص يمكن أن يستبدل في نفس المساحة. لقد تم توليد هذا النص من مولد النص العربي، حيث يمكنك أن تولد مثل هذا النص أو العديد من النصوص الأخرى إضافة إلى زيادة عدد الحروف التى يولدها التطبيق.
            </p>
           
        </div>

        <!-- Left: Images and colored blocks -->
        <div class="d-flex  flex-row-reverse  justify-content-center align-items-start  col-lg-7  mb-4 mb-lg-0 position-relative custom-col-full" style="  background:var(--bg); ">
           
            <!--Center: leaf icon -->
            <div class="position-absolute leaf d-flex justify-content-center align-items-center rounded-circle bg-orange text-white ">
                <img src="/images/leaf.svg" alt="Alternate Text" />
            </div>

            <div class="d-flex  flex-column  justify-content-center w-50 ">
                <div class=" d-flex transparent flex-row-reverse  justify-content-center align-items-end ">

                    <div class="outer-border" style="border-top:74px solid var(--bg);         background: var(--bg);
">
                        <div class="custom-bg-green rounded-20 box-border-fix " style="width:103px; height: 183px;  "></div>
                    </div>
                    <div class="bg-transparent rounded-20 overflow-hidden box-border-fix  outer-border" style="width: 90%; height: 247px; position:relative;  background-image:url(/images/cover.svg);    background-position: 21% 0%;">
                    </div>
                </div>

                <div class="d-flex transparent flex-row-reverse  justify-content-center alig-items-end   ">

                    <div class="custom-bg-orange rounded-20 d-flex align-items-center justify-content-center box-border-fix outer-border  " style="width: 57%; height: 240px; position:relative;overflow:hidden ">
                        <img src="/images/plane.svg" alt="Alternate Text" style="width:100%;" />
                    </div>

                    <div class="bg-transparent rounded-20 overflow-hidden  box-border-fix outer-border" style="width: 167px; height: 240px; position:relative; background-image:url(/images/cover.svg);    background-position: 33% 80%;">
                    </div>
                </div>
            </div>
            <div class="d-flex  flex-column  justify-content-center align-items-end  w-50 ">
                <div class="bg-transparent rounded-20 overflow-hidden  box-border-fix outer-border" style="width: 95%; height: 396px;  background-image:url(/images/cover.svg);    background-position: 71% 0%;">
                </div>
                <div style=" background:var(--bg) ;">
                    <div class="outer-border w-100" style="float: left;">
                        <div class="rounded-20 box-border-fix" style="width: 70%; min-width:283px;height: 89px; background: #C6ECC9; ">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<section class="latest-articles rtl py-5" style="background:#F6FBF7;">
    <div class="container">

        <!-- العنوان + زر عرض الكل -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="fw-bold" style="color:var(--green);">
                أحدث المقالات
            </h3>

            <a href="~/Home/Articles" class="view-all-btn">
                <iconify-icon icon="mdi:clock-outline"></iconify-icon>
                عرض الكل
            </a>
        </div>

        <!-- السلايدر (الكروت فقط) -->

        <div class="swiper articlesSwiper mb-4">
            <div class="swiper-wrapper">

                @foreach (var article in Model.LatestArticles)
                {
                    <div class="swiper-slide">
                        <div class="article-card">

                            <div class="article-img">
                                <img src="@(!string.IsNullOrEmpty(article.ImagePath)
                                                                 ? article.ImagePath
                                                                 : "/images/default-article.jpg")"
                                                                                                 alt="@article.Title" />
                                                                                        </div>

                            <div class="article-body">
                                <span class="article-date">
                                    @article.PublishDate.ToString("dd MMM yyyy")
                                </span>

                                <h5 class="article-title">
                                    @article.Title
                                </h5>

                                <p class="article-desc">
                                    @(article.Content.Length > 120
                                                                    ? article.Content.Substring(0, 120) + "..."
                                                                    : article.Content)
                            </p>

                                <a asp-controller="Articles"
                                   asp-action="Details"
                                   asp-route-id="@article.Id"
                                   class="read-more">
                                    اقرأ المزيد
                                    <iconify-icon icon="mdi:arrow-left"></iconify-icon>
                                </a>
                            </div>

                        </div>
                    </div>
                                }

            </div>
        </div>
        <!-- الأسهم تحت الكروت -->
        <div class="d-flex justify-content-center gap-3">
            <div class="swiper-button-prev custom-arrow"></div>
            <div class="swiper-button-next custom-arrow"></div>
        </div>

    </div>
</section>

<script>
    const container = document.getElementById("floatingShapes");
    const totalCount = 8;
    let circleCount = 5;
    let starCount = 3;

    const containerWidth = container.clientWidth;
    const spacing = containerWidth / totalCount;
    let fromTop = true;

    const colors = ['var(--orange)', 'var(--green)'];

    for (let i = 0; i < totalCount; i++) {
      let shape;
      let isCircle;

      // Decide whether to create a circle or star
      if (circleCount > 0 && starCount > 0) {
        isCircle = Math.random() > 0.5;
      } else if (circleCount > 0) {
        isCircle = true;
      } else {
        isCircle = false;
      }

      if (isCircle) {
        shape = document.createElement("span");
        shape.classList.add("shape", "circle");

        const size = 27 + Math.random() * (42 - 27);
        shape.style.width = `${size}px`;
        shape.style.height = `${size}px`;
        shape.style.opacity = `${0.5 + Math.random() * 0.2}`; // 0.5 - 0.7
        shape.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

        circleCount--;
      } else {
        shape = document.createElement("iconify-icon");
        shape.setAttribute("icon", "oui:sparkle-filled");
        shape.classList.add("shape", "star");

        const size = 32;
        shape.width = `${size}px`;
        shape.height = `${size}px`;
        shape.style.opacity = Math.random() > 0.5 ? "0.5" : "1";
        shape.style.color = colors[Math.floor(Math.random() * colors.length)];

        starCount--;
      }

      // Common styles
      shape.style.position = "absolute";
      shape.style.left = `${i * spacing}px`;

      if (i === totalCount - 1 && fromTop) {
        i = -1;
        fromTop = false;
        circleCount = 5;
        starCount = 3;
        continue;
      }

      if (fromTop) {
        shape.style.top = `${Math.random() *40 }px`;
      } else {
        shape.style.bottom = `${Math.random() * 40}px`;
      }

      shape.style.animationDelay = `${Math.random() * 7}s`;

      container.appendChild(shape);
    }
</script>
<script>
    new Swiper(".articlesSwiper", {
        slidesPerView: 3,
        spaceBetween: 25,
        loop: true,
        autoplay: {
            delay: 3500,
            disableOnInteraction: false,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        breakpoints: {
            0: { slidesPerView: 1 },
            768: { slidesPerView: 2 },
            1200: { slidesPerView: 3 }
        }
    });
</script>
