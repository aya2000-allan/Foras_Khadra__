@model Foras_Khadra.Models.LoginViewModel
@using Microsoft.Extensions.Options;
@using System.Globalization;
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = Localizer["PageTitle"];
    var culture = System.Globalization.CultureInfo.CurrentUICulture.TwoLetterISOLanguageName;
    var dir = culture == "ar" ? "rtl" : "ltr";
}

<div class="auth-page" dir="@dir">
    <div class="auth-bg-circle"></div>

    <div class="auth-card">
        <h1 class="auth-title">@Localizer["LoginTitle"]</h1>
        <p class="auth-subtitle">@Localizer["LoginSubtitle"]</p>

        <form asp-action="Login" method="post" class="mt-4">
            @Html.AntiForgeryToken()

            <div asp-validation-summary="All" class="text-danger mb-3"></div>

            <!-- Email -->
            <div class="mb-3">
                <label asp-for="Email" class="form-label auth-label">@Localizer["Email"]</label>
                <div class="auth-input">
                    <input asp-for="Email" class="form-control auth-control" placeholder="@Localizer["EmailPlaceholder"]" />
                </div>
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>

            <!-- Password -->
            <div class="mb-2">
                <label asp-for="Password" class="form-label auth-label">@Localizer["Password"]</label>

                <div class="auth-input has-icon">
                    <input asp-for="Password" id="Password" class="form-control auth-control" type="password" placeholder="@Localizer["PasswordPlaceholder"]" />
                    <button type="button" class="auth-eye" onclick="togglePassword()"
                            aria-label="إظهار/إخفاء كلمة المرور">
                        <!-- simple eye icon (SVG) -->
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                </div>

                <span asp-validation-for="Password" class="text-danger"></span>
            </div>

            <!-- Remember + Forgot -->
            <div class="d-flex align-items-center justify-content-between mt-2 mb-3 auth-row">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="rememberMe" />
                    <label class="form-check-label" for="rememberMe">@Localizer["RememberMe"]</label>
                </div>

                <a asp-action="ForgotPassword" asp-controller="Account" class="auth-link">
                    @Localizer["ForgotPassword"]
                </a>
            </div>

            <!-- Submit -->
            <button type="submit" class="btn auth-btn w-100"> @Localizer["LoginButton"]</button>

            


            <div class="auth-footer">
                <span>@Localizer["NoAccount"]</span>
                <a asp-action="RegisterUser" asp-controller="Account" class="auth-link ms-1">@Localizer["CreateAccount"]</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        // Toggle Password
        function togglePassword() {
            const el = document.getElementById('Password');
            el.type = (el.type === 'password') ? 'text' : 'password';
        }

        // SweetAlert for Organization Login
        @if (TempData["OrgLoginAlert"] != null)
        {
                <text>
                    const message = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(TempData["OrgLoginAlert"]));
                    const redirectUrl = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(TempData["OrgLoginRedirect"]));
                    const redirectText = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(TempData["OrgLoginRedirectText"]));

                   Swal.fire({
  icon: 'warning',
  html: `<div class="foras-swal-msg">${message}</div>`,
  confirmButtonText: redirectText,
  showConfirmButton: true,
  allowOutsideClick: false,
  iconColor: "#fff",
  confirmButtonColor: "#F99D27",
  customClass: {
    popup: "foras-swal",
    confirmButton: "foras-swal-btn",
    icon: "foras-swal-icon"
  }
}).then((result) => {
  if (result.isConfirmed && redirectUrl) {
    window.location.href = redirectUrl;
  }
});

                </text>
        }
    </script>

    <style>
        /* SweetAlert Center Text */
        .swal2-popup-center {
            direction: ltr; /* اتجاه عادي للصفحة */
            text-align: center;
        }

        .swal2-title-center {
            text-align: center;
        }
    </style>
}

<style>
    /* Page */
    .auth-page{
        min-height: calc(100vh - 120px);
        display:flex;
        align-items:center;
        justify-content:center;
        position:relative;
        padding:40px 16px;
        background:#F2FBF3; /* very light green */
        overflow:hidden;
        font-family: "Tajawal", "Cairo", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    }


    /* Big soft circle like the screenshot */
    .auth-bg-circle{
        position:absolute;
        width:783px;
        height:743px;
        border-radius:50%;
        background:#E2F6E4;
        top:50%;
        left:50%;
        transform:translate(-50%, -50%);
        z-index:0;
    }

    /* Card */
    .auth-card{
        width:100%;
        max-width:523px;
        height:745px; ;
        background:#fff;
        border-radius:18px;
        padding:28px 26px;
        box-shadow: 0 12px 30px rgba(0,0,0,.08);
        z-index:1;
    }

    .auth-title{
        margin:0;
        text-align:center;
        color:#25652C; /* green title */
        font-weight:600;
        font-size:48px;
        line-height:1.1;
        font-weight: semi-bold;
    }

    .auth-subtitle{
        margin-top:20px;
        margin-bottom:0;
        text-align:center;
        color:#25652C;
        font-size:20px;
        font-weight:300;
    }

    .auth-label{
        color:#000000;
        font-weight:700;
        font-size:13px;
        margin-bottom:8px;
        font-weight: bold;
    }

    .auth-input{
        position:relative;
    }

    .auth-control{
        border-radius:10px;
        padding:12px 14px;
        border:1px solid #dfe7e2;
        background:#fff;
        box-shadow:none !important;
    }
    .auth-control:focus{
        border-color:#9ad0a7;
        box-shadow: 0 0 0 .2rem rgba(43, 160, 82, .15) !important;
    }

    /* Eye button */
    .has-icon .auth-control{
        padding-left:44px; /* because RTL, icon on left */
    }
    .auth-eye{
        position:absolute;
        left:10px;
        top:50%;
        transform:translateY(-50%);
        border:0;
        background:transparent;
        color:#8aa496;
        padding:6px;
        cursor:pointer;
    }

    .auth-row .form-check-label{
        color:#2f3a33;
        font-size:13px;
        font-weight:600;
    }

    .auth-link{
        color:#2f3a33;
        text-decoration:none;
        font-size:13px;
        font-weight:700;
    }
    .auth-link:hover{ text-decoration:underline; }

    /* Orange button */
    .auth-btn{
        background:#f4a029;
        border:none;
        border-radius:10px;
        padding:12px 14px;
        font-weight:800;
        color:#fff;
        margin-top:6px;
    }
    .auth-btn:hover{ background:#ee9414; color:#fff; }

    /* Divider */
    .auth-divider{
        display:flex;
        align-items:center;
        justify-content:center;
        gap:12px;
        margin:18px 0 12px;
        color:#93a49a;
        font-size:12px;
        font-weight:700;
    }
    .auth-divider::before,
    .auth-divider::after{
        content:"";
        height:1px;
        background:#e8efe9;
        flex:1;
    }

    /* Social buttons */
    .auth-social{
        display:flex;
        gap:10px;
        justify-content:space-between;
        flex-wrap:wrap;
    }
    .auth-social-btn{
        flex:1;
        min-width:120px;
        display:flex;
        align-items:center;
        justify-content:center;
        gap:8px;
        padding:10px 10px;
        border:1px solid #dfe7e2;
        border-radius:10px;
        background:#fff;
        text-decoration:none;
        color:#2f3a33;
        font-weight:700;
        font-size:12px;
    }
    .auth-social-btn img{
        width:18px;
        height:18px;
    }

    .auth-footer{
        margin-top:60px;
        text-align:center;
        color:#25652C;
        font-size:16px;
        font-weight:400;
    }
    /* ===== Foras Swal Design (matches screenshot) ===== */
.foras-swal{
  border-radius: 22px !important;
  padding: 34px 26px 26px !important;
  box-shadow: 0 18px 45px rgba(0,0,0,.14) !important;
  max-width: 920px !important;
}

/* اتجاه حسب اللغة */
html[dir="rtl"] .foras-swal{ direction: rtl; }
html[dir="ltr"] .foras-swal{ direction: ltr; }

/* الأيقونة الدائرية البرتقالية */
.foras-swal .swal2-icon.foras-swal-icon{
  width: 70px !important;
  height: 70px !important;
  margin: 6px auto 14px !important;
  border: none !important;
  background: #F99D27 !important;
  color: #fff !important;
}
.foras-swal .swal2-icon.foras-swal-icon .swal2-icon-content{
  font-size: 44px !important;
  font-weight: 900 !important;
  line-height: 1 !important;
}

/* النص الأخضر الكبير */
.foras-swal-msg{
  color: #25652C;
  font-weight: 800;
  font-size: clamp(22px, 2.6vw, 34px);
  line-height: 1.35;
  text-align: center;
  margin: 4px auto 18px;
  max-width: 820px;
}

/* زر برتقالي كبسولة */
.foras-swal .swal2-confirm.foras-swal-btn{
  border-radius: 12px !important;
  padding: 14px 30px !important;
  font-weight: 800 !important;
  font-size: 16px !important;
  box-shadow: none !important;
}

/* مسافات داخلية */
.foras-swal .swal2-actions{
  margin: 10px 0 0 !important;
}


</style>
