@model Dictionary<Foras_Khadra.Models.OpportunityType, List<Foras_Khadra.Models.Opportunity>>

<h2>الفرص حسب النوع</h2>

<!-- زر إضافة فرصة أعلى الصفحة -->
<div class="mb-3 text-end">
    <a asp-action="Create" class="btn btn-success">إضافة فرصة جديدة</a>
</div>

<!-- Tabs -->
<ul class="nav nav-tabs" id="opportunityTab" role="tablist">
    @foreach (var group in Model)
    {
        var type = group.Key;
        var tabId = "tab" + type.ToString();
        var activeClass = group.Equals(Model.First()) ? "active" : "";

        <li class="nav-item" role="presentation">
            <button class="nav-link @activeClass" id="@tabId-tab" data-bs-toggle="tab" data-bs-target="#@tabId" type="button" role="tab" aria-controls="@tabId" aria-selected="@(activeClass == "active")">
                @type
            </button>
        </li>
    }
</ul>

<!-- Tab Content -->
<div class="tab-content mt-3" id="opportunityTabContent">
    @foreach (var group in Model)
    {
        var type = group.Key;
        var tabId = "tab" + type.ToString();
        var activeClass = group.Equals(Model.First()) ? "show active" : "";

        <div class="tab-pane fade @activeClass" id="@tabId" role="tabpanel" aria-labelledby="@tabId-tab">
            @if (group.Value.Count == 0)
            {
                <p>لا توجد فرص حالياً.</p>
            }
            else
            {
                <div class="row">
                    @foreach (var opp in group.Value)
                    {
                        <div class="col-md-4 mb-3">
                            <div class="card h-100">
                                @if (!string.IsNullOrEmpty(opp.ImagePath))
                                {
                                    <img src="@opp.ImagePath" class="card-img-top" alt="صورة الفرصة">
                                }
                                <div class="card-body">
                                    <h5 class="card-title">@opp.Title</h5>
                                    <p class="card-text">@opp.Description</p>

                                    <div class="d-flex flex-wrap gap-1">
                                        <!-- زر التفاصيل -->
                                        <a href="@Url.Action("Details", "Opportunity", new { id = opp.Id })"
                                           class="btn btn-primary btn-sm">
                                            عرض التفاصيل
                                        </a>

                                        <!-- زر التعديل -->
                                        <a href="@Url.Action("Edit", "Opportunity", new { id = opp.Id })"
                                           class="btn btn-warning btn-sm">
                                            تعديل
                                        </a>

                                        <!-- زر الحذف -->
                                        <form asp-action="Delete" asp-controller="Opportunity" asp-route-id="@opp.Id"
                                              method="post" onsubmit="return confirm('هل أنت متأكد من حذف هذه الفرصة؟');"
                                              style="display:inline;">
                                            <button type="submit" class="btn btn-danger btn-sm">
                                                حذف
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
        </div>
    }
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
